<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="xBFreE is a tool for Binding Free Energy calculations"><meta name=author content="Mario S. and Mario E. Valdés-Tresanco"><link href=https://xBFreEnergy.github.io/dev/api/ rel=canonical><link rel=icon href=../assets/logo.svg><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.4.8"><title>Python API - xBFreE Documentation</title><link rel=stylesheet href=../assets/stylesheets/main.4b4a2bd9.min.css><link rel=stylesheet href=../assets/stylesheets/palette.356b1318.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../css/timeago.css><link rel=stylesheet href=../assets/stylesheets/termynal.css><link rel=stylesheet href=../assets/stylesheets/custom.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config",""),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script><link rel=stylesheet href=../assets/stylesheets/global.css><script src=../assets/js/news.js></script><script type=text/javascript>
        loadNews("../news.json")
      </script><style>
.md-grid {
    max-width: 80rem;
}
</style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=purple data-md-color-accent=purple> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#python-api-for-gmx_mmpbsa-v15x-coming-soon class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button class="md-banner__button md-icon" aria-label="Don't show this again"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> <span class=title>NEWS</span> <div class=marquee> <ul class=marquee-content id=news-container> </ul> </div> </div> <script>var content,el=document.querySelector("[data-md-component=announce]");el&&(content=el.querySelector(".md-typeset"),__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0))</script> </aside> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> <aside class="md-banner md-banner--warning"> <div class="md-banner__inner md-grid md-typeset"> You're not viewing the latest version. <a href=../..> <strong>Click here to go to latest.</strong> </a> </div> <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="xBFreE Documentation" class="md-header__button md-logo" aria-label="xBFreE Documentation" data-md-component=logo> <img src=../assets/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> xBFreE Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Python API </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=purple data-md-color-accent=purple aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=purple data-md-color-accent=purple aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/xBFreEnergy/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> xBFreEnergy.github.io </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../getting-started/getting-started/ class=md-tabs__link> Getting started </a> </li> <li class=md-tabs__item> <a href=../mmpbsa/introduction/ class=md-tabs__link> MMPBSA </a> </li> <li class=md-tabs__item> <a href=../examples/ class=md-tabs__link> Examples </a> </li> <li class=md-tabs__item> <a href=../Q%26A/ class=md-tabs__link> Help </a> </li> <li class=md-tabs__item> <a href=../cite_us/ class=md-tabs__link> Cite xBFreE </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="xBFreE Documentation" class="md-nav__button md-logo" aria-label="xBFreE Documentation" data-md-component=logo> <img src=../assets/logo.svg alt=logo> </a> xBFreE Documentation </label> <div class=md-nav__source> <a href=https://github.com/xBFreEnergy/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> xBFreEnergy.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Getting started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../getting-started/getting-started/ class=md-nav__link> <span class=md-ellipsis> Getting started </span> </a> </li> <li class=md-nav__item> <a href=../getting-started/summary/ class=md-nav__link> <span class=md-ellipsis> xBFreE in a nutshell </span> </a> </li> <li class=md-nav__item> <a href=../getting-started/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../getting-started/command-line/ class=md-nav__link> <span class=md-ellipsis> Command-line </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> MMPBSA </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> MMPBSA </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../mmpbsa/introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../mmpbsa/versus/ class=md-nav__link> <span class=md-ellipsis> xBFreE vs other program </span> </a> </li> <li class=md-nav__item> <a href=../mmpbsa/howworks/ class=md-nav__link> <span class=md-ellipsis> How it works </span> </a> </li> <li class=md-nav__item> <a href=../mmpbsa/command-line/ class=md-nav__link> <span class=md-ellipsis> Command-line </span> </a> </li> <li class=md-nav__item> <a href=../mmpbsa/running_mmpbsa/ class=md-nav__link> <span class=md-ellipsis> Running MMPBSA calculations </span> </a> </li> <li class=md-nav__item> <a href=../mmpbsa/input_file/ class=md-nav__link> <span class=md-ellipsis> The input file </span> </a> </li> <li class=md-nav__item> <a href=../mmpbsa/pbradii/ class=md-nav__link> <span class=md-ellipsis> PBRadii </span> </a> </li> <li class=md-nav__item> <a href=../mmpbsa/output/ class=md-nav__link> <span class=md-ellipsis> The output file </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../examples/ class="md-nav__link "> <span class=md-ellipsis> Examples </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../examples/gmx_MMPBSA_test/ class=md-nav__link> <span class=md-ellipsis> gmx_MMPBSA_test </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_3> <div class="md-nav__link md-nav__container"> <a href=../examples/Protein_protein/ class="md-nav__link "> <span class=md-ellipsis> Systems </span> </a> <label class="md-nav__link " for=__nav_4_3 id=__nav_4_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../examples/Protein_ligand/ST/ class=md-nav__link> <span class=md-ellipsis> Protein-ligand </span> </a> </li> <li class=md-nav__item> <a href=../examples/Protein_DNA/ class=md-nav__link> <span class=md-ellipsis> Protein-DNA </span> </a> </li> <li class=md-nav__item> <a href=../examples/Protein_glycan/ class=md-nav__link> <span class=md-ellipsis> Protein-glycan </span> </a> </li> <li class=md-nav__item> <a href=../examples/Protein_membrane/ class=md-nav__link> <span class=md-ellipsis> Membrane proteins </span> </a> </li> <li class=md-nav__item> <a href=../examples/Metalloprotein_ligand/ class=md-nav__link> <span class=md-ellipsis> Metalloprotein-ligand </span> </a> </li> <li class=md-nav__item> <a href=../examples/Comp_receptor/ class=md-nav__link> <span class=md-ellipsis> Multicomponent system </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_3_8> <div class="md-nav__link md-nav__container"> <a href=../examples/COVID-19_related_proteins/ class="md-nav__link "> <span class=md-ellipsis> COVID-19 related proteins </span> </a> <label class="md-nav__link " for=__nav_4_3_8 id=__nav_4_3_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_3_8_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3_8> <span class="md-nav__icon md-icon"></span> COVID-19 related proteins </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../examples/COVID-19_related_proteins/Main_protease_7l5d/ class=md-nav__link> <span class=md-ellipsis> Main protease </span> </a> </li> <li class=md-nav__item> <a href=../examples/COVID-19_related_proteins/Papain-like_protease_7koj/ class=md-nav__link> <span class=md-ellipsis> Papain-like protease </span> </a> </li> <li class=md-nav__item> <a href=../examples/COVID-19_related_proteins/S1-ACE2_complex_7dmu/ class=md-nav__link> <span class=md-ellipsis> S1-ACE2 complex </span> </a> </li> <li class=md-nav__item> <a href=../examples/COVID-19_related_proteins/S1_RBD_with_antibody_6zlr/ class=md-nav__link> <span class=md-ellipsis> S1 RBD with antibody </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_4> <div class="md-nav__link md-nav__container"> <a href=../examples/Protein_ligand_CHARMMff/ class="md-nav__link "> <span class=md-ellipsis> CHARMMff Support </span> </a> <label class="md-nav__link " for=__nav_4_4 id=__nav_4_4_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> CHARMMff Support </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../examples/Protein_membrane_CHARMMff/ class=md-nav__link> <span class=md-ellipsis> Protein-ligand complex embedded in membrane </span> </a> </li> <li class=md-nav__item> <a href=../examples/Protein_ligand_LPH_atoms_CHARMMff/ class=md-nav__link> <span class=md-ellipsis> Protein-ligand with LPH particles (ST) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_5> <div class="md-nav__link md-nav__container"> <a href=../examples/OPLS/protein_protein/ class="md-nav__link "> <span class=md-ellipsis> OPLSff Support </span> </a> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_5_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> OPLSff Support </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_6> <div class="md-nav__link md-nav__container"> <a href=../examples/Protein_ligand/ST/ class="md-nav__link "> <span class=md-ellipsis> Analysis </span> </a> <label class="md-nav__link " for=__nav_4_6 id=__nav_4_6_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_6_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6> <span class="md-nav__icon md-icon"></span> Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../examples/Protein_ligand/MT/ class=md-nav__link> <span class=md-ellipsis> Multiple Trajectory Protocol </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_6_3> <div class="md-nav__link md-nav__container"> <a href=../examples/Protein_ligand/ST/ class="md-nav__link "> <span class=md-ellipsis> BFE calculations </span> </a> <label class="md-nav__link " for=__nav_4_6_3 id=__nav_4_6_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6_3> <span class="md-nav__icon md-icon"></span> BFE calculations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../examples/GBNSR6/ class=md-nav__link> <span class=md-ellipsis> BFE calculation with GBNSR6 </span> </a> </li> <li class=md-nav__item> <a href=../examples/Linear_PB_solver/ class=md-nav__link> <span class=md-ellipsis> BFE calculation with Linear PB </span> </a> </li> <li class=md-nav__item> <a href=../examples/NonLinear_PB_solver/ class=md-nav__link> <span class=md-ellipsis> BFE calculation with NonLinear PB </span> </a> </li> <li class=md-nav__item> <a href=../examples/3D-RISM/ class=md-nav__link> <span class=md-ellipsis> BFE calculation with 3D-RISM </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../examples/Alanine_scanning/ class=md-nav__link> <span class=md-ellipsis> Alanine scanning </span> </a> </li> <li class=md-nav__item> <a href=../examples/Decomposition_analysis/ class=md-nav__link> <span class=md-ellipsis> Decomposition analysis </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_6_6> <div class="md-nav__link md-nav__container"> <a href=../examples/Entropy_calculations/Interaction_Entropy/ class="md-nav__link "> <span class=md-ellipsis> Entropy calculations </span> </a> <label class="md-nav__link " for=__nav_4_6_6 id=__nav_4_6_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_6_6_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6_6> <span class="md-nav__icon md-icon"></span> Entropy calculations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../examples/Entropy_calculations/nmode/ class=md-nav__link> <span class=md-ellipsis> nmode Entropy </span> </a> </li> <li class=md-nav__item> <a href=../examples/Entropy_calculations/C2_Entropy/ class=md-nav__link> <span class=md-ellipsis> C2 Entropy calculations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../examples/Stability/ class=md-nav__link> <span class=md-ellipsis> Stability calculations </span> </a> </li> <li class=md-nav__item> <a href=../examples/QM_MMGBSA/ class=md-nav__link> <span class=md-ellipsis> QM/MMGBSA </span> </a> </li> <li class=md-nav__item> <a href=../examples/Correlation/ class=md-nav__link> <span class=md-ellipsis> Correlation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../Q%26A/ class="md-nav__link "> <span class=md-ellipsis> Help </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Help </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Q%26A/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../Q%26A/OS_issues/ class=md-nav__link> <span class=md-ellipsis> OS issues </span> </a> </li> <li class=md-nav__item> <a href=../Q%26A/calculations/ class=md-nav__link> <span class=md-ellipsis> Calculations </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_5> <label class=md-nav__link for=__nav_5_5 id=__nav_5_5_label tabindex> <span class=md-ellipsis> Info </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5_5> <span class="md-nav__icon md-icon"></span> Info </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> <li class=md-nav__item> <a href=../compatibility/ class=md-nav__link> <span class=md-ellipsis> Compatibility </span> </a> </li> <li class=md-nav__item> <a href=../private_policy/ class=md-nav__link> <span class=md-ellipsis> Private Policy </span> </a> </li> <li class=md-nav__item> <a href=../tags/ class=md-nav__link> <span class=md-ellipsis> Tags </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../cite_us/ class=md-nav__link> <span class=md-ellipsis> Cite xBFreE </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=python-api-for-gmx_mmpbsa-v15x-coming-soon>Python API for gmx_MMPBSA v1.5.x coming soon...<a class=headerlink href=#python-api-for-gmx_mmpbsa-v15x-coming-soon title="Permanent link">&para;</a></h1> <h1 id=python-api-for-gmx_mmpbsa-v143>Python API for gmx_MMPBSA v1.4.3<a class=headerlink href=#python-api-for-gmx_mmpbsa-v143 title="Permanent link">&para;</a></h1> <p>The aim of the <code>gmx_MMPBSA</code> API is to provide you with direct access to the raw data produced during a <code>gmx_MMPBSA</code> calculation. By default, gmx_MMPBSA calculates an average, standard deviation, and standard error of the mean for all the generated data sets, but it does not support custom analyses. The API reads an _GMXMMPBSA_info file, from which it will determine what kind of calculation was performed, then automatically parse the output files and load the data into arrays.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>The topology files you used in the <code>gmx_MMPBSA</code> calculation must also be available in the location specified in the _<code>GMXMMPBSA_info</code> file.</p> </div> <h2 id=using-the-api>Using the API<a class=headerlink href=#using-the-api title="Permanent link">&para;</a></h2> <p>We have derived a new API to reorganize the data so that it is arranged more hierarchically. This makes easier to transform the data into graphs in the <code>gmx_MMPBSA_ana</code>. **The original and the current API only differ in the name of the callable function, the disposition of the data in Per-wise decomposition analysis and in the new 'delta' key.</p> <p>The function <code>load_gmxmmpbsa_info</code> takes the name of a <code>gmx_MMPBSA</code> info file (typically <code>_GMXMMPBSA_info</code>) and returns a populated <code>mmpbsa_data</code> instance with all the parsed data. An example code snippet that creates a <code>mmpbsa_data</code> instance from the information in _<code>GMXMMPBSA_info</code> is shown below.</p> <div class="admonition important"> <p class=admonition-title>Important</p> <p>Unlike MMPBSA.py, <code>load_gmxmmpbsa_info</code> does not need to be located in the folder that contains the <code>_GMXMMPBSA_info</code> file.</p> <p><em>New in v1.4.0</em></p> </div> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>from</span> <span class=nn>GMXMMPBSA</span> <span class=kn>import</span> <span class=n>API</span> <span class=k>as</span> <span class=n>gmxMMPBSAapi</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=n>data</span> <span class=o>=</span> <span class=n>gmxMMPBSAapi</span><span class=o>.</span><span class=n>load_gmxmmpbsa_info</span><span class=p>(</span><span class=s2>&quot;_GMXMMPBSA_info&quot;</span><span class=p>)</span>
</code></pre></div> <h2 id=properties-of-mmpbsa_data>Properties of mmpbsa_data<a class=headerlink href=#properties-of-mmpbsa_data title="Permanent link">&para;</a></h2> <p>The <code>mmpbsa_data</code> class is a nested dictionary structure (<code>mmpbsa_data</code> is actually derived from <code>dict</code>). The various attributes of <code>mmpbsa_data</code> are described below followed by the defined operators.</p> <h3 id=attributes>Attributes<a class=headerlink href=#attributes title="Permanent link">&para;</a></h3> <p>If the numpy package is installed and available, all data arrays will be <code>numpy.ndarray</code> instances. Otherwise, all data arrays will be <code>array.array</code> instances with the ’d’ data type specifier (for a double precision float). The data is organized in an <code>mmpbsa_data</code> instance in the following manner:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=n>mmpbsa_data_instance</span><span class=p>[</span><span class=s1>&#39;calc_key&#39;</span><span class=p>][</span><span class=s1>&#39;system_component&#39;</span><span class=p>][</span><span class=s1>&#39;energy_term&#39;</span><span class=p>]</span>
</code></pre></div> <p>In this example, <code>calc_key</code> is a <code>dict</code> key that is paired to another <code>dict</code> (<code>mmpbsa_data_instance</code> is the first-level <code>dict</code>, in this case) (Table 2). The keys of these second-level dict instances (<code>system_component</code>) pair to another <code>dict</code> (Table 3).</p> <p>Table 2. List and description of <code>calc_key</code> dict keys that may be present in instances of the <code>mmpbsa_data</code> class.</p> <table> <thead> <tr> <th style="text-align: center;">Dictionary Key (calc_key)</th> <th style="text-align: left;">Calculation Type</th> </tr> </thead> <tbody> <tr> <td style="text-align: center;"><code>gb</code></td> <td style="text-align: left;">Generalized Born Results</td> </tr> <tr> <td style="text-align: center;"><code>pb</code></td> <td style="text-align: left;">Poisson-Boltzmann Results</td> </tr> <tr> <td style="text-align: center;"><code>rism gf</code></td> <td style="text-align: left;">Gaussian Fluctuation 3D-RISM Results</td> </tr> <tr> <td style="text-align: center;"><code>rism std</code></td> <td style="text-align: left;">Standard 3D-RISM Results</td> </tr> <tr> <td style="text-align: center;"><code>ie</code></td> <td style="text-align: left;">Interaction Entropy Results</td> </tr> <tr> <td style="text-align: center;"><code>nmode</code></td> <td style="text-align: left;">Normal Mode Analysis Results</td> </tr> <tr> <td style="text-align: center;"><code>qh</code></td> <td style="text-align: left;">Quasi-harmonic Approximation Results</td> </tr> </tbody> </table> <p>Table 3. List and description of system_component keys that may be present in instances of the mmpbsa_data class.</p> <table> <thead> <tr> <th style="text-align: center;">Dictionary Key (system_component)</th> <th style="text-align: left;">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: center;"><code>complex</code></td> <td style="text-align: left;">Data sets for the complex. (Stability &amp; Binding)</td> </tr> <tr> <td style="text-align: center;"><code>receptor</code></td> <td style="text-align: left;">Data sets for the receptor. (Binding only)</td> </tr> <tr> <td style="text-align: center;"><code>ligand</code></td> <td style="text-align: left;">Data sets for the ligand. (Binding only)</td> </tr> <tr> <td style="text-align: center;"><code>delta</code></td> <td style="text-align: left;">Data sets for the delta. (Binding only)</td> </tr> </tbody> </table> <p>The keys of these inner-most (third-level) <code>dict</code> instances are paired with the data arrays for that energy term (Table 4). The various dictionary keys are listed below for each level. If alanine scanning was performed, the <code>mmpbsa_data_instance</code> also has a <code>"mutant"</code> attribute that contains the same dictionary structure as <code>mmpbsa_data</code> does for the normal system. If not, the mutant attribute is None. The only difference is that the data is accessed as follows:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=n>mmpbsa_data_instance</span><span class=o>.</span><span class=n>mutant</span><span class=p>[</span><span class=s1>&#39;calc_key&#39;</span><span class=p>][</span><span class=s1>&#39;system_component&#39;</span><span class=p>][</span><span class=s1>&#39;energy_term&#39;</span><span class=p>]</span>
</code></pre></div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>All keys are case-sensitive, and if a space appears in the key, it must be present in your program. Also, if polar/non-polar decomposition is not performed for <code>3D-RISM</code>, then the <code>POLAR SOLV</code> and <code>APOLAR SOLV</code> keys are replaced with the single key <code>ERISM</code></p> </div> <p>Table 4. List and description of energy_term keys that may be present in instances of the mmpbsa_data class. The allowed values of energy_term depend on the value of calc_key above in Table 2. The <code>energy_term</code> keys are listed for each <code>calc_key</code> enumerated above, accompanied by a description. The RISM keys are the same for both <code>rism gf</code> and <code>rism std</code> although the value of <code>POLAR SOLV</code> and <code>APOLAR SOLV</code> will differ depending on the method chosen. Those keys marked with * are specific to the CHARMM force field used through chamber. Those arrays are all 0 for normal Amber topology files.</p> <table> <thead> <tr> <th style="text-align: left;">Description</th> <th style="text-align: center;"><code>gb</code></th> <th style="text-align: center;"><code>pb</code></th> <th style="text-align: center;"><code>RISM</code></th> </tr> </thead> <tbody> <tr> <td style="text-align: left;">Bond energy</td> <td style="text-align: center;"><code>BOND</code></td> <td style="text-align: center;"><code>BOND</code></td> <td style="text-align: center;"><code>BOND</code></td> </tr> <tr> <td style="text-align: left;">Angle energy</td> <td style="text-align: center;"><code>ANGLE</code></td> <td style="text-align: center;"><code>ANGLE</code></td> <td style="text-align: center;"><code>ANGLE</code></td> </tr> <tr> <td style="text-align: left;">Dihedral Energy</td> <td style="text-align: center;"><code>DIHED</code></td> <td style="text-align: center;"><code>DIHED</code></td> <td style="text-align: center;"><code>DIHED</code></td> </tr> <tr> <td style="text-align: left;">Urey-Bradley*</td> <td style="text-align: center;"><code>UB</code></td> <td style="text-align: center;"><code>UB</code></td> <td style="text-align: center;">—</td> </tr> <tr> <td style="text-align: left;">Improper Dihedrals*</td> <td style="text-align: center;"><code>IMP</code></td> <td style="text-align: center;"><code>IMP</code></td> <td style="text-align: center;">—</td> </tr> <tr> <td style="text-align: left;">Correction Map*</td> <td style="text-align: center;"><code>CMAP</code></td> <td style="text-align: center;"><code>CMAP</code></td> <td style="text-align: center;">—</td> </tr> <tr> <td style="text-align: left;">1-4 van der Waals energy</td> <td style="text-align: center;"><code>1-4 VDW</code></td> <td style="text-align: center;"><code>1-4 VDW</code></td> <td style="text-align: center;"><code>1-4 VDW</code></td> </tr> <tr> <td style="text-align: left;">1-4 Electrostatic energy</td> <td style="text-align: center;"><code>1-4 EEL</code></td> <td style="text-align: center;"><code>1-4 EEL</code></td> <td style="text-align: center;"><code>1-4 EEL</code></td> </tr> <tr> <td style="text-align: left;">van der Waals energy</td> <td style="text-align: center;"><code>VDWAALS</code></td> <td style="text-align: center;"><code>VDWAALS</code></td> <td style="text-align: center;"><code>VDWAALS</code></td> </tr> <tr> <td style="text-align: left;">Electrostatic energy</td> <td style="text-align: center;"><code>EEL</code></td> <td style="text-align: center;"><code>EEL</code></td> <td style="text-align: center;"><code>EEL</code></td> </tr> <tr> <td style="text-align: left;">Polar solvation energy</td> <td style="text-align: center;"><code>EGB</code></td> <td style="text-align: center;"><code>EPB</code></td> <td style="text-align: center;"><code>POLAR SOLV</code></td> </tr> <tr> <td style="text-align: left;">Non-polar solvation energy</td> <td style="text-align: center;"><code>ESURF</code></td> <td style="text-align: center;"><code>ENPOLAR</code></td> <td style="text-align: center;"><code>APOLAR SOLV</code></td> </tr> <tr> <td style="text-align: left;">Total solvation free energy</td> <td style="text-align: center;"><code>G solv</code></td> <td style="text-align: center;"><code>G solv</code></td> <td style="text-align: center;"><code>G solv</code></td> </tr> <tr> <td style="text-align: left;">Total gas phase free energy</td> <td style="text-align: center;"><code>G gas</code></td> <td style="text-align: center;"><code>G gas</code></td> <td style="text-align: center;"><code>G gas</code></td> </tr> <tr> <td style="text-align: left;">Total energy</td> <td style="text-align: center;"><code>TOTAL</code></td> <td style="text-align: center;"><code>TOTAL</code></td> <td style="text-align: center;"><code>TOTAL</code></td> </tr> </tbody> </table> <p>Table 5. Same as Table 4 for the entropy (nmode and qh) data.</p> <table> <thead> <tr> <th style="text-align: left;">Description</th> <th style="text-align: center;"><code>nmode</code></th> <th style="text-align: center;"><code>qh</code></th> </tr> </thead> <tbody> <tr> <td style="text-align: left;">Translational entropy</td> <td style="text-align: center;"><code>Translational</code></td> <td style="text-align: center;"><code>Translational</code></td> </tr> <tr> <td style="text-align: left;">Rotational entropy</td> <td style="text-align: center;"><code>Rotational</code></td> <td style="text-align: center;"><code>Rotational</code></td> </tr> <tr> <td style="text-align: left;">Vibrational entropy</td> <td style="text-align: center;"><code>Vibrational</code></td> <td style="text-align: center;"><code>Vibrational</code></td> </tr> <tr> <td style="text-align: left;">Total entropy</td> <td style="text-align: center;"><code>Total</code></td> <td style="text-align: center;"><code>Total</code></td> </tr> </tbody> </table> <p>Table 6. Same as Table 5 for the Interaction Entropy data.</p> <table> <thead> <tr> <th style="text-align: left;">Description</th> <th style="text-align: center;"><code>IE</code></th> </tr> </thead> <tbody> <tr> <td style="text-align: left;">Data per-frame</td> <td style="text-align: center;"><code>data</code></td> </tr> <tr> <td style="text-align: left;">Mean of the selected interval</td> <td style="text-align: center;"><code>value</code></td> </tr> <tr> <td style="text-align: left;">Star and End frames of the selected interval</td> <td style="text-align: center;"><code>frames</code></td> </tr> </tbody> </table> <h3 id=defined-operators>Defined operators<a class=headerlink href=#defined-operators title="Permanent link">&para;</a></h3> <p>In-place addition: It extends all the arrays that are common to both <code>mmpbsa_data</code> instances. This is useful if, for instance, you run two <code>gmx_MMPBSA</code> calculations, and you use -prefix <new_prefix> for the second simulation. Assuming that <new_prefix> is <code>_GMXMMPBSA2_</code> for the second <code>gmx_MMPBSA</code> calculation, the following pseudo-code will generate a mmpbsa_data instance with all the data in concatenated arrays. The pseudo-code assumes GMXMMPBSA.API was imported as demonstrated below.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=n>data</span> <span class=o>=</span> <span class=n>gmxMMPBSAapi</span><span class=o>.</span><span class=n>load_gmxmmpbsa_info</span><span class=p>(</span><span class=s2>&quot;_GMXMMPBSA_info&quot;</span><span class=p>)</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=n>data</span> <span class=o>+=</span> <span class=n>gmxMMPBSAapi</span><span class=o>.</span><span class=n>load_gmxmmpbsa_info</span><span class=p>(</span><span class=s2>&quot;_GMXMMPBSA2_info&quot;</span><span class=p>)</span>
</code></pre></div> <h2 id=example-api-usage>Example API Usage<a class=headerlink href=#example-api-usage title="Permanent link">&para;</a></h2> <p>In many cases, the autocorrelation function of the energy can aid in the analysis of MM/PBSA data, since it provides a way of determining the statistical independence of your data points. For example, 1000 correlated snapshots provide less information, and therefore less statistical certainty, than 1000 uncorrelated snapshots. The standard error of the mean calculation performed by <code>gmx_MMPBSA</code> assumes a completely uncorrelated set of snapshots, which means that it is a lower bound of the true standard error of the mean, and a plot of the autocorrelation function may help determine the actual value.</p> <p>The example program below will calculate the autocorrelation function of the total energy (complex only for both the normal and alanine mutant systems) from a GB calculation and plot the resulting code using matplotlib.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=kn>import</span> <span class=nn>os</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=kn>import</span> <span class=nn>sys</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=c1># append AMBERHOME/bin to sys.path</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=n>sys</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s1>&#39;AMBERHOME&#39;</span><span class=p>),</span> <span class=s1>&#39;bin&#39;</span><span class=p>))</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=c1># Now import the MMPBSA API</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=kn>from</span> <span class=nn>GMXMMPBSA</span> <span class=kn>import</span> <span class=n>API</span> <span class=k>as</span> <span class=n>gmxMMPBSAapi</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=n>data</span> <span class=o>=</span> <span class=n>gmxMMPBSAapi</span><span class=o>.</span><span class=n>load_gmxmmpbsa_info</span><span class=p>(</span><span class=s1>&#39;_GMXMMPBSA_info&#39;</span><span class=p>)</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=n>total</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;gb&#39;</span><span class=p>][</span><span class=s1>&#39;complex&#39;</span><span class=p>][</span><span class=s1>&#39;TOTAL&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=n>data</span> <span class=o>=</span> <span class=n>gmxMMPBSAapi</span><span class=o>.</span><span class=n>load_gmxmmpbsa_info</span><span class=p>(</span><span class=s1>&#39;_GMXMMPBSA_info&#39;</span><span class=p>)</span>
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=n>total_mut</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>mutant</span><span class=p>[</span><span class=s1>&#39;gb&#39;</span><span class=p>][</span><span class=s1>&#39;complex&#39;</span><span class=p>][</span><span class=s1>&#39;TOTAL&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=c1># Create a second copy of the data set. The np.correlate function does not</span>
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=c1># normalize the correlation function, so we modify total and total2 to get</span>
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a><span class=c1># that effect</span>
<a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a><span class=n>total</span> <span class=o>-=</span> <span class=n>total</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
<a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=n>total</span> <span class=o>/=</span> <span class=n>total</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
<a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a><span class=n>total2</span> <span class=o>=</span> <span class=n>total</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>total</span><span class=p>)</span>
<a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a><span class=n>acor</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>correlate</span><span class=p>(</span><span class=n>total</span><span class=p>,</span> <span class=n>total2</span><span class=p>,</span> <span class=s1>&#39;full&#39;</span><span class=p>)</span>
<a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a><span class=n>total_mut</span> <span class=o>-=</span> <span class=n>total_mut</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
<a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a><span class=n>total_mut</span> <span class=o>/=</span> <span class=n>total_mut</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
<a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a><span class=n>total2_mut</span> <span class=o>=</span> <span class=n>total_mut</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>total_mut</span><span class=p>)</span>
<a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a><span class=n>acor_mut</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>correlate</span><span class=p>(</span><span class=n>total_mut</span><span class=p>,</span> <span class=n>total2_mut</span><span class=p>,</span> <span class=s1>&#39;full&#39;</span><span class=p>)</span>
<a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a><span class=c1># Now generate the &#39;lag&#39; axis</span>
<a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a><span class=n>xdata</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>total</span><span class=p>))</span>
<a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a><span class=c1># The acor data set is symmetric about the origin, so only accept the</span>
<a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a><span class=c1># positive lag times. Graph the result</span>
<a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>xdata</span><span class=p>,</span> <span class=n>acor</span><span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>acor</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span><span class=p>:],</span> <span class=n>xdata</span><span class=p>,</span> <span class=n>acor_mut</span><span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>acor</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span><span class=p>:])</span>
<a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <h2 id=decomposition-data>Decomposition Data<a class=headerlink href=#decomposition-data title="Permanent link">&para;</a></h2> <p>When performing decomposition analysis, the various decomp data is stored in a separate tree of dicts referenced with the <code>decomp</code> key. The key sequence is similar to the sequence for the <code>normal</code> data described above, where <code>decomp</code> is followed by the solvent model (<code>GB</code> or <code>PB</code>), followed by the species (<code>complex</code>, <code>receptor</code>, or <code>ligand</code>) (additionally, we include <code>delta</code> key), followed by the decomposition components (total, backbone, or sidechain), followed by the residue number (and residue pair for pairwise decomposition), finally followed by the contribution (<code>internal</code>, <code>van der Waals</code>, <code>electrostatics</code>, etc.) The available keys are shown in Figure 1 (and each key is described afterwards).</p> <p><strong>Decomp Key Descriptions:</strong></p> <ul> <li><code>gb</code> All Generalized Born results</li> <li><code>pb</code> All Poisson-Boltzmann results</li> <li><code>complex</code> All results from the complex trajectory</li> <li><code>receptor</code> All results from the receptor trajectory</li> <li><code>ligand</code> All results from the ligand trajectory</li> <li><code>delta</code> All results from delta total decomposition [ complex TDC - (receptor TDC + ligand TDC) ]</li> <li><code>TDC</code> All results from the total decomposition</li> <li><code>SDC</code> All results from the sidechain decomposition</li> <li><code>BDC</code> All results from the backbone decomposition</li> <li><code>#</code> All data from residue number <code>#</code> in per-residue and per-wise decomposition (same residue numbering scheme as in each respective topology file)<ul> <li><code>##</code> All interaction energies between residues <code>##</code> and their respective pair <code>#</code> in per-wise decomposition (same residue numbering scheme as in each respective topology file)</li> </ul> </li> <li><code>int</code> Internal energy contributions (see the idecomp variable description above)</li> <li><code>vdw</code> van der Waals energy contributions</li> <li><code>eel</code> Electrostatic energy contributions</li> <li><code>pol</code> Polar solvation free energy contributions</li> <li><code>sas</code> Non-polar solvation free energy contributions</li> <li><code>tot</code> Total free energy contributions (sum of previous 5).</li> </ul> <figure> <p><a href=../assets/images/decomp_dict_keys.png><img alt=decomp src=../assets/images/decomp_dict_keys.png></a> </p> <figcaption style=margin-top:0;> <p><strong>Figure 1</strong>. Tree of <code>dict</code> keys following the <code>decomp</code> key in a <code>mmpbsa_data</code> instance. </p> </figcaption> </figure> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2023-06-24T15:50:49+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-06-24</span> <br> Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2023-06-24T15:50:49+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-06-24</span> </small> </div> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> Was this page helpful? </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81Z"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14Z"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> Thanks for your feedback! </div> <div data-md-value=0 hidden> Thanks for your feedback! Help us improve this page by using our <a href=... target=_blank rel=noopener>feedback form</a>. </div> </div> </div> </fieldset> </form> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2020 - 2023 MS. and ME. Valdés-Tresanco </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/xBFreEnergy target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use Google Analytics as a third party tracking service. We do not share, sell, rent, or trade this information with third parties for their commercial purposes; and we only use it as this Privacy Policy describes. This helps us improve documentation and have usage statistics to apply for financing. Thank you.</p> <input class=md-toggle type=checkbox id=__settings checked> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script> <script id=__config type=application/json>{"base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.expand", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../assets/javascripts/bundle.81fa17fe.min.js></script> <script src=../js/timeago.min.js></script> <script src=../js/timeago_mkdocs_material.js></script> <script src=../assets/js/termynal.js></script> <script src=../assets/js/custom.js></script> <script src=../assets/js/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>