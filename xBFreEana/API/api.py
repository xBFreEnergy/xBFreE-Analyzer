from pathlib import Path
from types import SimpleNamespace
from xBFreE.mmpbsa.utils.energy import EnergyVector
from xBFreE.mmpbsa.API import MMPBSA_API
import pandas
from typing import Union



data = SimpleNamespace(
    normal={
        'gb': {
            'complex': {
                'BOND': EnergyVector([122.9518, 121.3934, 104.6352, 109.2969, 123.921, 111.2909, 133.5119, 124.952, 128.5033, 110.9953,
                     123.1986]),
                'ANGLE': EnergyVector([299.2949, 309.9723, 315.6794, 317.0133, 289.6172, 312.362, 304.9561, 311.539, 337.007, 306.5211,
                     324.2809]),
                'DIHED': EnergyVector([493.4171, 497.6102, 500.6493, 497.7456, 505.2563, 506.5586, 497.9765, 499.7582, 483.2845, 506.7182,
                     501.4662]),
                'VDWAALS': EnergyVector([-248.6712, -244.9224, -232.4481, -244.2, -237.0251, -244.7395, -238.575, -237.5625, -241.4268,
                     -228.3706,
                     -229.9364]),
                'EEL': EnergyVector([-2627.416, -2663.7876, -2614.5387, -2631.3674, -2621.5759, -2616.6273, -2602.2669, -2590.1838,
                     -2591.7345, -2590.5302, -2600.4156]),
                '1-4 VDW': EnergyVector([131.1106, 142.452, 132.4758, 135.3818, 134.3316, 127.5628, 125.7378, 125.1549, 132.6016, 134.9047,
                     129.541]),
                '1-4 EEL': EnergyVector([1649.3116, 1660.8163, 1644.9257, 1629.2386, 1624.1963, 1640.9854, 1628.1959, 1618.7741, 1624.6637,
                     1642.3309, 1630.6393]),
                'EGB': EnergyVector([-998.9017, -988.0492, -1024.1284, -991.0351, -993.1573, -1007.9598, -1019.7837, -1012.6733,
                     -1021.532, -1038.9715, -1030.7223]),
                'ESURF': EnergyVector([22.27785408, 21.61571544, 21.48189048, 21.59694144, 21.69274032, 21.66888024, 21.7507716,
                     21.58532424, 21.68256312, 21.214134, 21.62598984]),
                'GGAS': EnergyVector([-180.0012, -176.4658, -148.6214, -186.8912, -181.2786, -162.6071, -150.4637, -147.5681, -127.1012,
                     -117.4306, -121.226]),
                'GSOLV': EnergyVector([-976.62384592, -966.43348456, -1002.64650952,
                                       -969.43815856, -971.46455968, -986.29091976,
                                       -998.0329284, -991.08797576, -999.84943688,
                                       -1017.757366, -1009.09631016]),
                'TOTAL': EnergyVector([-1156.62504592, -1142.89928456, -1151.26790952,
                                       -1156.32935856, -1152.74315968, -1148.89801976,
                                       -1148.4966284, -1138.65607576, -1126.95063688,
                                       -1135.187966, -1130.32231016])
            },
            'receptor': {
                'BOND': EnergyVector([97.545, 99.1341, 81.2525, 85.9637, 97.1465, 90.0304,
                                      107.1009, 96.9877, 104.4141, 84.124, 93.2857]),
                'ANGLE': EnergyVector([222.9429, 231.0853, 238.5185, 237.1662, 214.1181, 242.3548,
                                       222.9434, 235.5166, 253.2445, 237.7786, 260.6215]),
                'DIHED': EnergyVector([389.7582, 396.1064, 397.2523, 391.8453, 399.6736, 396.274,
                                       391.402, 386.4523, 383.528, 401.9945, 391.3797]),
                'VDWAALS': EnergyVector([-186.4148, -189.8157, -182.7216, -185.7451, -181.6132,
                                         -189.8939, -187.6604, -181.1656, -190.2684, -181.0079,
                                         -179.1181]),
                'EEL': EnergyVector([-2164.5212, -2200.0384, -2141.0484, -2151.8194, -2154.5418,
                                     -2150.0797, -2146.4514, -2131.9514, -2137.3478, -2126.9643,
                                     -2142.5195]),
                '1-4 VDW': EnergyVector([105.8874, 118.7582, 107.3619, 107.9729, 109.0321, 103.4139,
                                         101.6377, 102.8174, 109.1906, 109.5735, 105.6431]),
                '1-4 EEL': EnergyVector([1491.3199, 1506.6144, 1493.94, 1477.1613, 1471.4377,
                                         1480.4533, 1479.9943, 1463.0728, 1478.968, 1476.721,
                                         1475.5585]),
                'EGB': EnergyVector([-828.908, -815.5352, -857.4886, -834.797, -828.3883,
                                     -834.5955, -838.1501, -835.7353, -842.2624, -852.487,
                                     -849.9082]),
                'ESURF': EnergyVector([18.4407948, 17.7267132, 17.91102024, 18.0919584,
                                       17.93753208, 17.8774992, 17.82199152, 17.85214512,
                                       18.04726296, 17.51308128, 17.73566568]),
                'GGAS': EnergyVector([-43.4826, -38.1557, -5.4448, -37.4551, -44.747, -27.4472,
                                      -31.0335, -28.2702, 1.729, 2.2194, 4.8509]),
                'GSOLV': EnergyVector([-810.4672052, -797.8084868, -839.57757976, -816.7050416,
                                       -810.45076792, -816.7180008, -820.32810848, -817.88315488,
                                       -824.21513704, -834.97391872, -832.17253432]),
                'TOTAL': EnergyVector([-853.9498052, -835.9641868, -845.02237976, -854.1601416,
                                       -855.19776792, -844.1652008, -851.36160848, -846.15335488,
                                       -822.48613704, -832.75451872, -827.32163432])
            },
            'ligand': {
                'BOND': EnergyVector([25.4068, 22.2593, 23.3828, 23.3332, 26.7745, 21.2605,
                                      26.4109, 27.9643, 24.0892, 26.8713, 29.9129]),
                'ANGLE': EnergyVector([76.3521, 78.887, 77.1609, 79.8471, 75.4991, 70.0073,
                                       82.0127, 76.0224, 83.7625, 68.7426, 63.6594]),
                'DIHED': EnergyVector([103.6588, 101.5038, 103.397, 105.9003, 105.5827, 110.2846,
                                       106.5745, 113.306, 99.7565, 104.7237, 110.0865]),
                'VDWAALS': EnergyVector([-23.2049, -19.7949, -21.0962, -23.1546, -19.4198, -21.3283,
                                         -20.7999, -20.5768, -19.1962, -19.0206, -18.2501]),
                'EEL': EnergyVector([-424.658, -421.1046, -418.8417, -425.8116, -422.2685,
                                     -414.6688, -402.2363, -407.513, -400.7753, -408.3691,
                                     -408.5555]),
                '1-4 VDW': EnergyVector([25.2232, 23.6937, 25.1139, 27.4089, 25.2994, 24.1489,
                                         24.1001, 22.3375, 23.411, 25.3311, 23.8978]),
                '1-4 EEL': EnergyVector([157.9917, 154.2018, 150.9857, 152.0773, 152.7587, 160.5321,
                                         148.2016, 155.7013, 145.6957, 165.6099, 155.0808]),
                'EGB': EnergyVector([-222.6628, -223.8933, -226.8314, -218.761, -221.3748,
                                     -234.9757, -242.7495, -237.8037, -241.4963, -246.9069,
                                     -240.0248]),
                'ESURF': EnergyVector([8.18102736, 8.25733512, 8.21299608, 8.18543304, 8.22062376,
                                       8.32518936, 8.42094288, 8.37472608, 8.41345056, 8.27177544,
                                       8.31240936]),
                'GGAS': EnergyVector([-59.2303, -60.3539, -59.8976, -60.3994, -55.7739, -49.7637,
                                      -35.7364, -32.7583, -43.2566, -36.1111, -44.1682]),
                'GSOLV': EnergyVector([-214.48177264, -215.63596488, -218.61840392, -210.57556696,
                                       -213.15417624, -226.65051064, -234.32855712, -229.42897392,
                                       -233.08284944, -238.63512456, -231.71239064]),
                'TOTAL': EnergyVector([-273.71207264, -275.98986488, -278.51600392, -270.97496696,
                                       -268.92807624, -276.41421064, -270.06495712, -262.18727392,
                                       -276.33944944, -274.74622456, -275.88059064])
            },
            'delta': {
                'BOND': EnergyVector([3.55271368e-15, -3.55271368e-15, -1.00000000e-04,
                                      -1.06581410e-14, 3.55271368e-15, -7.10542736e-15,
                                      1.00000000e-04, -7.10542736e-15, -1.06581410e-14,
                                      3.55271368e-15, -7.10542736e-15]),
                'ANGLE': EnergyVector([-1.00000000e-04, 2.84217094e-14, 0.00000000e+00,
                                       1.42108547e-14, 2.84217094e-14, -1.00000000e-04,
                                       0.00000000e+00, -2.84217094e-14, 1.42108547e-14,
                                       -1.00000000e-04, -4.97379915e-14]),
                'DIHED': EnergyVector([1.00000000e-04, 1.42108547e-14, -1.42108547e-14,
                                       1.42108547e-14, -1.42108547e-14, 1.42108547e-14,
                                       0.00000000e+00, -1.00000000e-04, -4.26325641e-14,
                                       1.42108547e-14, 0.00000000e+00]),
                'VDWAALS': EnergyVector([-39.0515, -35.3118, -28.6303, -35.3003, -35.9921, -33.5173,
                     -30.1147, -35.8201, -31.9622, -28.3421, -32.5682]),
                'EEL': EnergyVector([-38.2368, -42.6446, -54.6486, -53.7364, -44.7656, -51.8788,
                     -53.5792, -50.7194, -53.6114, -55.1968, -49.3406]),
                '1-4 VDW': EnergyVector([7.10542736e-15, 1.00000000e-04, -1.42108547e-14,
                     3.55271368e-15, 1.00000000e-04, -3.55271368e-15,
                     -3.55271368e-15, -7.10542736e-15, -1.42108547e-14,
                     1.00000000e-04, 1.00000000e-04]),
                '1-4 EEL': EnergyVector([2.84217094e-14, 1.00000000e-04, -5.68434189e-14,
                     -8.52651283e-14, -9.99999999e-05, 1.13686838e-13,
                     -1.42108547e-13, 1.70530257e-13, 0.00000000e+00,
                     -8.52651283e-14, -5.68434189e-14]),
                'EGB': EnergyVector([52.6691, 51.3793, 60.1916, 62.5229, 56.6058, 61.6114,
                     61.1159, 60.8657, 62.2267, 60.4224, 59.2107]),
                'ESURF': EnergyVector([-4.34396808, -4.36833288, -4.64212584, -4.68045,
                                       -4.46541552, -4.53380832, -4.4921628,
                                       -4.64154696,
                                       -4.7781504, -4.57072272, -4.4220852]),
                'GGAS': EnergyVector([-77.2883, -77.9564, -83.2789, -89.0367, -80.7577, -85.3961,
                     -83.6939, -86.5395, -85.5736, -83.5389, -81.9088]),
                'GSOLV': EnergyVector([48.32513192, 47.01096712, 55.54947416, 57.84245,
                                       52.14038448, 57.07759168, 56.6237372,
                                       56.22415304,
                                       57.4485496, 55.85167728, 54.7886148]),
                'TOTAL': EnergyVector([-28.96316808, -30.94543288, -27.72942584, -31.19425,
                     -28.61731552, -28.31850832, -27.0701628, -30.31534696,
                     -28.1250504, -27.68722272, -27.1201852])
            }
        },
        'gbnsr6': {
            'complex': {
                'BOND': EnergyVector([122.9518, 121.3934, 104.6352, 109.2969, 123.921, 111.2909,
                                      133.5119, 124.952, 128.5033, 110.9953, 123.1986]),
                'ANGLE': EnergyVector([299.2949, 309.9723, 315.6794, 317.0133, 289.6172, 312.362,
                                       304.9561, 311.539, 337.007, 306.5211, 324.2809]),
                'DIHED': EnergyVector([493.4171, 497.6102, 500.6493, 497.7456, 505.2563, 506.5586,
                                       497.9765, 499.7582, 483.2845, 506.7182, 501.4662]),
                'VDWAALS': EnergyVector([-248.6712, -244.9224, -232.4481, -244.2, -237.0251,
                                         -244.7395, -238.575, -237.5625, -241.4268, -228.3706,
                                         -229.9364]),
                'EEL': EnergyVector([-2627.4159, -2663.781, -2614.5389, -2631.379, -2621.5766,
                                     -2616.6339, -2602.2667, -2590.1837, -2591.7344, -2590.5303,
                                     -2600.4095]),
                '1-4 VDW': EnergyVector([131.1106, 142.452, 132.4758, 135.3818, 134.3316, 127.5628,
                                         125.7378, 125.1549, 132.6016, 134.9047, 129.541]),
                '1-4 EEL': EnergyVector([1649.3116, 1660.8158, 1644.9258, 1629.2672, 1624.1985,
                                         1640.9901, 1628.1958, 1618.774, 1624.6637, 1642.3307,
                                         1630.6393]),
                'EGB': EnergyVector([-1006.0036, -995.7008, -1027.5827, -996.6963, -993.119,
                                     -1005.4821, -1020.9576, -1010.9158, -1021.7297, -1040.4671,
                                     -1026.8773]),
                'ESURF': EnergyVector([17.8904, 17.4525, 17.3685, 17.5775, 17.4821, 17.571,
                                       17.4743, 17.4771, 17.4693, 17.4053, 17.6675]),
                'GGAS': EnergyVector([-180.0011, -176.4597, -148.6215, -186.8742, -181.2771,
                                      -162.609, -150.4636, -147.5681, -127.1011, -117.4309,
                                      -121.2199]),
                'GSOLV': EnergyVector([-988.1132, -978.2483, -1010.2142, -979.1188, -975.6369,
                                       -987.9111, -1003.4833, -993.4387, -1004.2604, -1023.0618,
                                       -1009.2098]),
                'TOTAL': EnergyVector([-1168.1143, -1154.708, -1158.8357, -1165.993, -1156.914,
                                       -1150.5201, -1153.9469, -1141.0068, -1131.3615, -1140.4927,
                                       -1130.4297])
            },
            'receptor': {
                'BOND': EnergyVector([97.545, 99.1341, 81.2525, 85.9637, 97.1465, 90.0304,
                                      107.1009, 96.9877, 104.4141, 84.124, 93.2857]),
                'ANGLE': EnergyVector([222.9429, 231.0853, 238.5185, 237.1662, 214.1181, 242.3548,
                                       222.9434, 235.5166, 253.2445, 237.7786, 260.6215]),
                'DIHED': EnergyVector([389.7582, 396.1064, 397.2523, 391.8453, 399.6736, 396.274,
                                       391.402, 386.4523, 383.528, 401.9945, 391.3797]),
                'VDWAALS': EnergyVector([-186.4148, -189.8157, -182.7216, -185.7451, -181.6132,
                                         -189.8939, -187.6604, -181.1656, -190.2684, -181.0079,
                                         -179.1181]),
                'EEL': EnergyVector([-2164.5212, -2200.0382, -2141.0486, -2151.8359, -2154.5433,
                                     -2150.0861, -2146.4512, -2131.9514, -2137.3477, -2126.9644,
                                     -2142.5153]),
                '1-4 VDW': EnergyVector([105.8874, 118.7582, 107.3619, 107.9729, 109.0321, 103.4139,
                                         101.6377, 102.8174, 109.1906, 109.5735, 105.6431]),
                '1-4 EEL': EnergyVector([1491.3198, 1506.6144, 1493.9401, 1477.1923, 1471.4507,
                                         1480.458, 1479.9942, 1463.0727, 1478.9679, 1476.7209,
                                         1475.5607]),
                'EGB': EnergyVector([-834.7153, -823.6917, -858.587, -838.6092, -830.5353,
                                     -833.1627, -839.2296, -834.065, -844.5788, -853.8269,
                                     -850.5329]),
                'ESURF': EnergyVector([14.7711, 14.3188, 14.4835, 14.7487, 14.4346, 14.4911,
                                       14.4361, 14.4889, 14.5845, 14.3649, 14.5744]),
                'GGAS': EnergyVector([-43.4827, -38.1555, -5.4449, -37.4406, -44.7355, -27.4489,
                                      -31.0334, -28.2703, 1.729, 2.2192, 4.8573]),
                'GSOLV': EnergyVector([-819.9442, -809.3729, -844.1035, -823.8605, -816.1007,
                                       -818.6716, -824.7935, -819.5761, -829.9943, -839.462,
                                       -835.9585]),
                'TOTAL': EnergyVector([-863.4269, -847.5284, -849.5484, -861.3011, -860.8362,
                                       -846.1205, -855.8269, -847.8464, -828.2653, -837.2428,
                                       -831.1012])
            },
            'ligand': {
                'BOND': EnergyVector([25.4068, 22.2593, 23.3828, 23.3332, 26.7745, 21.2605,
                                      26.4109, 27.9643, 24.0892, 26.8713, 29.9129]),
                'ANGLE': EnergyVector([76.3521, 78.887, 77.1609, 79.8471, 75.4991, 70.0073,
                                       82.0127, 76.0224, 83.7625, 68.7426, 63.6594]),
                'DIHED': EnergyVector([103.6588, 101.5038, 103.397, 105.9003, 105.5827, 110.2846,
                                       106.5745, 113.306, 99.7565, 104.7237, 110.0865]),
                'VDWAALS': EnergyVector([-23.2049, -19.7949, -21.0962, -23.1546, -19.4198, -21.3283,
                                         -20.7999, -20.5768, -19.1962, -19.0206, -18.2501]),
                'EEL': EnergyVector([-424.658, -421.0982, -418.8417, -425.8077, -422.2635,
                                     -414.6688, -402.2363, -407.5129, -400.7753, -408.3691,
                                     -408.5532]),
                '1-4 VDW': EnergyVector([25.2232, 23.6937, 25.1139, 27.4089, 25.2994, 24.1489,
                                         24.1001, 22.3375, 23.411, 25.3311, 23.8978]),
                '1-4 EEL': EnergyVector([157.9918, 154.2015, 150.9857, 152.0749, 152.7478, 160.5321,
                                         148.2016, 155.7014, 145.6958, 165.6098, 155.0786]),
                'EGB': EnergyVector([-222.9572, -223.9248, -228.0079, -219.9696, -221.8866,
                                     -234.0441, -242.0392, -237.0463, -240.971, -247.8515,
                                     -239.8422]),
                'ESURF': EnergyVector([6.9755, 6.9805, 6.8816, 6.9392, 7.0342, 7.0646, 7.1024,
                                       7.1275, 7.1043, 7.0227, 7.0488]),
                'GGAS': EnergyVector([-59.2302, -60.3478, -59.8976, -60.3979, -55.7798, -49.7637,
                                      -35.7364, -32.7581, -43.2565, -36.1112, -44.1681]),
                'GSOLV': EnergyVector([-215.9817, -216.9443, -221.1263, -213.0304, -214.8524,
                                       -226.9795, -234.9368, -229.9188, -233.8667, -240.8288,
                                       -232.7934]),
                'TOTAL': EnergyVector([-275.2119, -277.2921, -281.0239, -273.4283, -270.6322,
                                       -276.7432, -270.6732, -262.6769, -277.1232, -276.94,
                                       -276.9615])
            },
            'delta': {
                'BOND': EnergyVector([3.55271368e-15, -3.55271368e-15, -1.00000000e-04,
                                      -1.06581410e-14, 3.55271368e-15, -7.10542736e-15,
                                      1.00000000e-04, -7.10542736e-15, -1.06581410e-14,
                                      3.55271368e-15, -7.10542736e-15]),
                'ANGLE': EnergyVector([-1.00000000e-04, 2.84217094e-14, 0.00000000e+00,
                                       1.42108547e-14, 2.84217094e-14, -1.00000000e-04,
                                       0.00000000e+00, -2.84217094e-14, 1.42108547e-14,
                                       -1.00000000e-04, -4.97379915e-14]),
                'DIHED': EnergyVector([1.00000000e-04, 1.42108547e-14, -1.42108547e-14,
                                       1.42108547e-14, -1.42108547e-14, 1.42108547e-14,
                                       0.00000000e+00, -1.00000000e-04, -4.26325641e-14,
                                       1.42108547e-14, 0.00000000e+00]),
                'VDWAALS': EnergyVector([-39.0515, -35.3118, -28.6303, -35.3003, -35.9921, -33.5173,
                                         -30.1147, -35.8201, -31.9622, -28.3421, -32.5682]),
                'EEL': EnergyVector([-38.2367, -42.6446, -54.6486, -53.7354, -44.7698, -51.879,
                                     -53.5792, -50.7194, -53.6114, -55.1968, -49.341]),
                '1-4 VDW': EnergyVector([7.10542736e-15, 1.00000000e-04, -1.42108547e-14,
                                         3.55271368e-15, 1.00000000e-04, -3.55271368e-15,
                                         -3.55271368e-15, -7.10542736e-15, -1.42108547e-14,
                                         1.00000000e-04, 1.00000000e-04]),
                '1-4 EEL': EnergyVector([0.00000000e+00, -9.99999999e-05, -5.68434189e-14,
                                         5.68434189e-14, -1.42108547e-13, -1.13686838e-13,
                                         -1.42108547e-13, -1.00000000e-04, -2.84217094e-14,
                                         -5.68434189e-14, 5.68434189e-14]),
                'EGB': EnergyVector([51.6689, 51.9157, 59.0122, 61.8825, 59.3029, 61.7247,
                                     60.3112, 60.1955, 63.8201, 61.2113, 63.4978]),
                'ESURF': EnergyVector([-3.8562, -3.8468, -3.9966, -4.1104, -3.9867, -3.9847,
                                       -4.0642, -4.1393, -4.2195, -3.9823, -3.9557]),
                'GGAS': EnergyVector([-77.2882, -77.9564, -83.2789, -89.0357, -80.7619, -85.3963,
                                      -83.6939, -86.5395, -85.5736, -83.5389, -81.9092]),
                'GSOLV': EnergyVector([47.8127, 48.0689, 55.0156, 57.7721, 55.3162, 57.74,
                                       56.247, 56.0562, 59.6006, 57.229, 59.5421]),
                'TOTAL': EnergyVector([-29.4755, -29.8875, -28.2633, -31.2636, -25.4457, -27.6563,
                                       -27.4469, -30.4833, -25.973, -26.3099, -22.3671])
            }
        }
    },
    mutant={},
    mut_norm={},
    decomp_normal={}, decomp_mutant={})

mmpbsa = MMPBSA_API()
mmpbsa.setting_time()
mmpbsa.load_file("/home/mario/Documents/xBFreE_test/1.x.x/examples/gmx_example/COMPACT_RESULTS_MMPBSA.xbfree")

print(mmpbsa.get_energy())



class